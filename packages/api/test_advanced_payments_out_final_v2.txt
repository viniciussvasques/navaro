Using selector: EpollSelector
Using selector: EpollSelector
[2m2026-02-05T14:51:00.228690Z[0m [[32m[1minfo     [0m] [1mStarting application          [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mname[0m=[35m'Navaro API'[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,290 INFO sqlalchemy.engine.Engine select pg_catalog.version()
select pg_catalog.version()
2026-02-05 15:51:00,291 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:00,297 INFO sqlalchemy.engine.Engine select current_schema()
select current_schema()
2026-02-05 15:51:00,297 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:00,301 INFO sqlalchemy.engine.Engine show standard_conforming_strings
show standard_conforming_strings
2026-02-05 15:51:00,301 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:00,305 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,312 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,313 INFO sqlalchemy.engine.Engine [generated in 0.00065s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[generated in 0.00065s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,333 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,334 INFO sqlalchemy.engine.Engine [cached since 0.02178s ago] ('establishments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.02178s ago] ('establishments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,337 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,337 INFO sqlalchemy.engine.Engine [cached since 0.02549s ago] ('service_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.02549s ago] ('service_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,341 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,342 INFO sqlalchemy.engine.Engine [cached since 0.02965s ago] ('services', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.02965s ago] ('services', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,345 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,345 INFO sqlalchemy.engine.Engine [cached since 0.03334s ago] ('service_bundles', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.03334s ago] ('service_bundles', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,347 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,348 INFO sqlalchemy.engine.Engine [cached since 0.03577s ago] ('service_bundle_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.03577s ago] ('service_bundle_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,350 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,351 INFO sqlalchemy.engine.Engine [cached since 0.03865s ago] ('staff_members', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.03865s ago] ('staff_members', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,352 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,353 INFO sqlalchemy.engine.Engine [cached since 0.0406s ago] ('staff_blocks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.0406s ago] ('staff_blocks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,354 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,354 INFO sqlalchemy.engine.Engine [cached since 0.04212s ago] ('subscription_plans', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.04212s ago] ('subscription_plans', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,356 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,356 INFO sqlalchemy.engine.Engine [cached since 0.04426s ago] ('subscription_plan_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.04426s ago] ('subscription_plan_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,359 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,359 INFO sqlalchemy.engine.Engine [cached since 0.04697s ago] ('subscriptions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.04697s ago] ('subscriptions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,361 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,362 INFO sqlalchemy.engine.Engine [cached since 0.04984s ago] ('subscription_usage', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.04984s ago] ('subscription_usage', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,364 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,364 INFO sqlalchemy.engine.Engine [cached since 0.05241s ago] ('appointments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.05241s ago] ('appointments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,367 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,367 INFO sqlalchemy.engine.Engine [cached since 0.05526s ago] ('appointment_products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.05526s ago] ('appointment_products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,370 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,370 INFO sqlalchemy.engine.Engine [cached since 0.05821s ago] ('checkins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.05821s ago] ('checkins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,372 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,373 INFO sqlalchemy.engine.Engine [cached since 0.06073s ago] ('queue_entries', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.06073s ago] ('queue_entries', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,375 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,375 INFO sqlalchemy.engine.Engine [cached since 0.06349s ago] ('reviews', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.06349s ago] ('reviews', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,377 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,377 INFO sqlalchemy.engine.Engine [cached since 0.06536s ago] ('favorites', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.06536s ago] ('favorites', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,380 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,380 INFO sqlalchemy.engine.Engine [cached since 0.06835s ago] ('favorite_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.06835s ago] ('favorite_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,382 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,382 INFO sqlalchemy.engine.Engine [cached since 0.0701s ago] ('payments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.0701s ago] ('payments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,386 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,387 INFO sqlalchemy.engine.Engine [cached since 0.07477s ago] ('tips', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.07477s ago] ('tips', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,389 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,390 INFO sqlalchemy.engine.Engine [cached since 0.07766s ago] ('payouts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.07766s ago] ('payouts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,392 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,393 INFO sqlalchemy.engine.Engine [cached since 0.08068s ago] ('portfolio_images', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.08068s ago] ('portfolio_images', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,395 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,395 INFO sqlalchemy.engine.Engine [cached since 0.08323s ago] ('search_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.08323s ago] ('search_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,397 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,397 INFO sqlalchemy.engine.Engine [cached since 0.08547s ago] ('products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.08547s ago] ('products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,400 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,400 INFO sqlalchemy.engine.Engine [cached since 0.08795s ago] ('establishment_plugins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.08795s ago] ('establishment_plugins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,401 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,402 INFO sqlalchemy.engine.Engine [cached since 0.08973s ago] ('ad_campaigns', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.08973s ago] ('ad_campaigns', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,405 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,405 INFO sqlalchemy.engine.Engine [cached since 0.09332s ago] ('notifications', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.09332s ago] ('notifications', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,409 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,409 INFO sqlalchemy.engine.Engine [cached since 0.09705s ago] ('user_debts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.09705s ago] ('user_debts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,412 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,412 INFO sqlalchemy.engine.Engine [cached since 0.1004s ago] ('user_wallets', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.1004s ago] ('user_wallets', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,415 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2026-02-05 15:51:00,416 INFO sqlalchemy.engine.Engine [cached since 0.1037s ago] ('wallet_transactions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
[cached since 0.1037s ago] ('wallet_transactions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2026-02-05 15:51:00,421 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,422 INFO sqlalchemy.engine.Engine [generated in 0.00058s] ('userrole', 'pg_catalog')
[generated in 0.00058s] ('userrole', 'pg_catalog')
2026-02-05 15:51:00,428 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,428 INFO sqlalchemy.engine.Engine [cached since 0.007259s ago] ('establishmentcategory', 'pg_catalog')
[cached since 0.007259s ago] ('establishmentcategory', 'pg_catalog')
2026-02-05 15:51:00,433 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,433 INFO sqlalchemy.engine.Engine [cached since 0.01206s ago] ('establishmentstatus', 'pg_catalog')
[cached since 0.01206s ago] ('establishmentstatus', 'pg_catalog')
2026-02-05 15:51:00,437 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,437 INFO sqlalchemy.engine.Engine [cached since 0.01623s ago] ('subscriptiontier', 'pg_catalog')
[cached since 0.01623s ago] ('subscriptiontier', 'pg_catalog')
2026-02-05 15:51:00,441 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,442 INFO sqlalchemy.engine.Engine [cached since 0.02044s ago] ('subscriptionstatus', 'pg_catalog')
[cached since 0.02044s ago] ('subscriptionstatus', 'pg_catalog')
2026-02-05 15:51:00,446 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,446 INFO sqlalchemy.engine.Engine [cached since 0.02526s ago] ('appointmentstatus', 'pg_catalog')
[cached since 0.02526s ago] ('appointmentstatus', 'pg_catalog')
2026-02-05 15:51:00,449 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,450 INFO sqlalchemy.engine.Engine [cached since 0.02839s ago] ('paymenttype', 'pg_catalog')
[cached since 0.02839s ago] ('paymenttype', 'pg_catalog')
2026-02-05 15:51:00,452 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,453 INFO sqlalchemy.engine.Engine [cached since 0.03148s ago] ('queuestatus', 'pg_catalog')
[cached since 0.03148s ago] ('queuestatus', 'pg_catalog')
2026-02-05 15:51:00,455 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,455 INFO sqlalchemy.engine.Engine [cached since 0.03397s ago] ('paymentpurpose', 'pg_catalog')
[cached since 0.03397s ago] ('paymentpurpose', 'pg_catalog')
2026-02-05 15:51:00,458 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,458 INFO sqlalchemy.engine.Engine [cached since 0.03696s ago] ('paymentstatus', 'pg_catalog')
[cached since 0.03696s ago] ('paymentstatus', 'pg_catalog')
2026-02-05 15:51:00,462 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,462 INFO sqlalchemy.engine.Engine [cached since 0.04091s ago] ('notificationtype', 'pg_catalog')
[cached since 0.04091s ago] ('notificationtype', 'pg_catalog')
2026-02-05 15:51:00,465 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,466 INFO sqlalchemy.engine.Engine [cached since 0.0444s ago] ('debtstatus', 'pg_catalog')
[cached since 0.0444s ago] ('debtstatus', 'pg_catalog')
2026-02-05 15:51:00,468 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,469 INFO sqlalchemy.engine.Engine [cached since 0.04758s ago] ('transactiontype', 'pg_catalog')
[cached since 0.04758s ago] ('transactiontype', 'pg_catalog')
2026-02-05 15:51:00,473 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
2026-02-05 15:51:00,473 INFO sqlalchemy.engine.Engine [cached since 0.0523s ago] ('transactionstatus', 'pg_catalog')
[cached since 0.0523s ago] ('transactionstatus', 'pg_catalog')
2026-02-05 15:51:00,475 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
[2m2026-02-05T14:51:00.477510Z[0m [[32m[1minfo     [0m] [1mDatabase initialized          [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m
[2m2026-02-05T14:51:00.484614Z[0m [[32m[1minfo     [0m] [1mVerification code sent        [0m [[0m[1m[34mapp.api.v1.auth[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/send-code[0m [36mphone[0m=[35m+5511988887777[0m [36mrequest_id[0m=[35m3cc0a62e-dc57-4010-a42f-7947bcce6511[0m [36mversion[0m=[35m1.0.0[0m
[2m2026-02-05T14:51:00.485475Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m5.28[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/send-code[0m [36mrequest_id[0m=[35m3cc0a62e-dc57-4010-a42f-7947bcce6511[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,494 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,643 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.phone = $1::VARCHAR
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.phone = $1::VARCHAR
2026-02-05 15:51:00,643 INFO sqlalchemy.engine.Engine [generated in 0.00052s] ('+5511988887777',)
[generated in 0.00052s] ('+5511988887777',)
[2m2026-02-05T14:51:00.694056Z[0m [[32m[1minfo     [0m] [1mUser authenticated            [0m [[0m[1m[34mapp.api.v1.auth[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/verify[0m [36mrequest_id[0m=[35m87ad2b89-8e8b-40be-bcba-45b7d1db45f9[0m [36muser_id[0m=[35m1bec427c-d8f4-47f8-963a-f2dcba2a6133[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,695 INFO sqlalchemy.engine.Engine ROLLBACK
ROLLBACK
[2m2026-02-05T14:51:00.695812Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m208.69[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/verify[0m [36mrequest_id[0m=[35m87ad2b89-8e8b-40be-bcba-45b7d1db45f9[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,703 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,706 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:00,706 INFO sqlalchemy.engine.Engine [generated in 0.00038s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[generated in 0.00038s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:00,717 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,717 INFO sqlalchemy.engine.Engine [generated in 0.00067s] ('advanced-barbershop',)
[generated in 0.00067s] ('advanced-barbershop',)
2026-02-05 15:51:00,741 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,742 INFO sqlalchemy.engine.Engine [cached since 0.02532s ago] ('advanced-barbershop-1',)
[cached since 0.02532s ago] ('advanced-barbershop-1',)
2026-02-05 15:51:00,744 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,744 INFO sqlalchemy.engine.Engine [cached since 0.02744s ago] ('advanced-barbershop-2',)
[cached since 0.02744s ago] ('advanced-barbershop-2',)
2026-02-05 15:51:00,747 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,747 INFO sqlalchemy.engine.Engine [cached since 0.03052s ago] ('advanced-barbershop-3',)
[cached since 0.03052s ago] ('advanced-barbershop-3',)
2026-02-05 15:51:00,751 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,751 INFO sqlalchemy.engine.Engine [cached since 0.03459s ago] ('advanced-barbershop-4',)
[cached since 0.03459s ago] ('advanced-barbershop-4',)
2026-02-05 15:51:00,753 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,753 INFO sqlalchemy.engine.Engine [cached since 0.03705s ago] ('advanced-barbershop-5',)
[cached since 0.03705s ago] ('advanced-barbershop-5',)
2026-02-05 15:51:00,755 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,756 INFO sqlalchemy.engine.Engine [cached since 0.03932s ago] ('advanced-barbershop-6',)
[cached since 0.03932s ago] ('advanced-barbershop-6',)
2026-02-05 15:51:00,757 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,758 INFO sqlalchemy.engine.Engine [cached since 0.04124s ago] ('advanced-barbershop-7',)
[cached since 0.04124s ago] ('advanced-barbershop-7',)
2026-02-05 15:51:00,762 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
2026-02-05 15:51:00,762 INFO sqlalchemy.engine.Engine [cached since 0.04567s ago] ('advanced-barbershop-8',)
[cached since 0.04567s ago] ('advanced-barbershop-8',)
2026-02-05 15:51:00,769 INFO sqlalchemy.engine.Engine INSERT INTO establishments (owner_id, name, slug, category, description, address, city, state, zip_code, latitude, longitude, phone, whatsapp, logo_url, cover_url, google_place_id, google_maps_url, business_hours, queue_mode_enabled, status, subscription_tier, stripe_account_id, cancellation_fee_fixed, no_show_fee_percent, deposit_percent, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::establishmentcategory, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::NUMERIC(10, 8), $11::NUMERIC(11, 8), $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::JSON, $19::BOOLEAN, $20::establishmentstatus, $21::subscriptiontier, $22::VARCHAR, $23::NUMERIC(10, 2), $24::NUMERIC(5, 2), $25::NUMERIC(5, 2), $26::UUID) RETURNING establishments.created_at, establishments.updated_at
INSERT INTO establishments (owner_id, name, slug, category, description, address, city, state, zip_code, latitude, longitude, phone, whatsapp, logo_url, cover_url, google_place_id, google_maps_url, business_hours, queue_mode_enabled, status, subscription_tier, stripe_account_id, cancellation_fee_fixed, no_show_fee_percent, deposit_percent, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::establishmentcategory, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::NUMERIC(10, 8), $11::NUMERIC(11, 8), $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::JSON, $19::BOOLEAN, $20::establishmentstatus, $21::subscriptiontier, $22::VARCHAR, $23::NUMERIC(10, 2), $24::NUMERIC(5, 2), $25::NUMERIC(5, 2), $26::UUID) RETURNING establishments.created_at, establishments.updated_at
2026-02-05 15:51:00,769 INFO sqlalchemy.engine.Engine [generated in 0.00103s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 'Advanced Barbershop', 'advanced-barbershop-8', 'barbershop', None, 'Feature St', 'São Paulo', 'SP', None, None, None, '+551177777777', None, None, None, None, None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', False, 'pending', 'trial', None, 0.0, 50.0, 0.0, UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'))
[generated in 0.00103s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 'Advanced Barbershop', 'advanced-barbershop-8', 'barbershop', None, 'Feature St', 'São Paulo', 'SP', None, None, None, '+551177777777', None, None, None, None, None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', False, 'pending', 'trial', None, 0.0, 50.0, 0.0, UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'))
2026-02-05 15:51:00,776 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
2026-02-05 15:51:00,782 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,784 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
2026-02-05 15:51:00,784 INFO sqlalchemy.engine.Engine [generated in 0.00025s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[generated in 0.00025s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:00,791 INFO sqlalchemy.engine.Engine ROLLBACK
ROLLBACK
[2m2026-02-05T14:51:00.792463Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m94.41[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments[0m [36mrequest_id[0m=[35mc3d64587-d529-4167-8f86-a26bf86c2f0d[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,801 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,802 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:00,802 INFO sqlalchemy.engine.Engine [cached since 0.09661s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.09661s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:00,811 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
2026-02-05 15:51:00,812 INFO sqlalchemy.engine.Engine [generated in 0.00052s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[generated in 0.00052s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:00,818 INFO sqlalchemy.engine.Engine INSERT INTO staff_members (establishment_id, user_id, name, phone, role, avatar_url, work_schedule, commission_rate, active, id) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::JSON, $8::NUMERIC(5, 2), $9::BOOLEAN, $10::UUID) RETURNING staff_members.created_at, staff_members.updated_at
INSERT INTO staff_members (establishment_id, user_id, name, phone, role, avatar_url, work_schedule, commission_rate, active, id) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::JSON, $8::NUMERIC(5, 2), $9::BOOLEAN, $10::UUID) RETURNING staff_members.created_at, staff_members.updated_at
2026-02-05 15:51:00,819 INFO sqlalchemy.engine.Engine [generated in 0.00072s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), None, 'Expert Barber', None, 'barber', None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', None, True, UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'))
[generated in 0.00072s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), None, 'Expert Barber', None, 'barber', None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', None, True, UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'))
2026-02-05 15:51:00,825 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
2026-02-05 15:51:00,829 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,971 INFO sqlalchemy.engine.Engine SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
2026-02-05 15:51:00,971 INFO sqlalchemy.engine.Engine [generated in 0.00059s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
[generated in 0.00059s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
2026-02-05 15:51:00,977 INFO sqlalchemy.engine.Engine ROLLBACK
ROLLBACK
[2m2026-02-05T14:51:00.977745Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m182.59[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments/b5fe8b83-db99-451f-9e3a-165ca14a88de/staff[0m [36mrequest_id[0m=[35ma5cbb7fb-9516-4163-a159-36adc6c45be0[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:00,986 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:00,987 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:00,987 INFO sqlalchemy.engine.Engine [cached since 0.2815s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.2815s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:00,992 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
2026-02-05 15:51:00,992 INFO sqlalchemy.engine.Engine [cached since 0.1813s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[cached since 0.1813s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:00,997 INFO sqlalchemy.engine.Engine INSERT INTO services (establishment_id, name, description, price, duration_minutes, active, sort_order, deposit_required, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::NUMERIC(10, 2), $5::INTEGER, $6::BOOLEAN, $7::INTEGER, $8::BOOLEAN, $9::UUID) RETURNING services.created_at, services.updated_at
INSERT INTO services (establishment_id, name, description, price, duration_minutes, active, sort_order, deposit_required, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::NUMERIC(10, 2), $5::INTEGER, $6::BOOLEAN, $7::INTEGER, $8::BOOLEAN, $9::UUID) RETURNING services.created_at, services.updated_at
2026-02-05 15:51:00,998 INFO sqlalchemy.engine.Engine [generated in 0.00070s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'Luxury Cut', None, 100.0, 60, True, 0, True, UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'))
[generated in 0.00070s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'Luxury Cut', None, 100.0, 60, True, 0, True, UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'))
2026-02-05 15:51:01,005 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
2026-02-05 15:51:01,014 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,017 INFO sqlalchemy.engine.Engine SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
2026-02-05 15:51:01,017 INFO sqlalchemy.engine.Engine [generated in 0.00104s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
[generated in 0.00104s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
2026-02-05 15:51:01,026 INFO sqlalchemy.engine.Engine ROLLBACK
ROLLBACK
[2m2026-02-05T14:51:01.027531Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m47.36[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments/b5fe8b83-db99-451f-9e3a-165ca14a88de/services[0m [36mrequest_id[0m=[35m3b09b916-e981-4822-bc9d-936524caaba1[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:01,085 INFO sqlalchemy.engine.Engine select pg_catalog.version()
select pg_catalog.version()
2026-02-05 15:51:01,085 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:01,090 INFO sqlalchemy.engine.Engine select current_schema()
select current_schema()
2026-02-05 15:51:01,090 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:01,095 INFO sqlalchemy.engine.Engine show standard_conforming_strings
show standard_conforming_strings
2026-02-05 15:51:01,095 INFO sqlalchemy.engine.Engine [raw sql] ()
[raw sql] ()
2026-02-05 15:51:01,097 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,099 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:01,099 INFO sqlalchemy.engine.Engine [generated in 0.00035s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[generated in 0.00035s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,150 INFO sqlalchemy.engine.Engine SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
2026-02-05 15:51:01,150 INFO sqlalchemy.engine.Engine [generated in 0.00045s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
[generated in 0.00045s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
2026-02-05 15:51:01,160 INFO sqlalchemy.engine.Engine SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
2026-02-05 15:51:01,161 INFO sqlalchemy.engine.Engine [generated in 0.00086s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
[generated in 0.00086s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
2026-02-05 15:51:01,170 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
2026-02-05 15:51:01,171 INFO sqlalchemy.engine.Engine [generated in 0.00066s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[generated in 0.00066s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:01,194 INFO sqlalchemy.engine.Engine SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
2026-02-05 15:51:01,194 INFO sqlalchemy.engine.Engine [generated in 0.00039s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 7, 15, 51, 1, 30577, tzinfo=datetime.timezone.utc))
[generated in 0.00039s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 7, 15, 51, 1, 30577, tzinfo=datetime.timezone.utc))
2026-02-05 15:51:01,203 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
2026-02-05 15:51:01,204 INFO sqlalchemy.engine.Engine [generated in 0.00050s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc))
[generated in 0.00050s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc))
2026-02-05 15:51:01,234 INFO sqlalchemy.engine.Engine INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
2026-02-05 15:51:01,234 INFO sqlalchemy.engine.Engine [generated in 0.00083s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 7, 15, 51, 1, 30577), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
[generated in 0.00083s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 7, 15, 51, 1, 30577), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
2026-02-05 15:51:01,243 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
2026-02-05 15:51:01,252 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,255 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
2026-02-05 15:51:01,255 INFO sqlalchemy.engine.Engine [generated in 0.00040s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
[generated in 0.00040s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
2026-02-05 15:51:01,263 INFO sqlalchemy.engine.Engine SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
2026-02-05 15:51:01,264 INFO sqlalchemy.engine.Engine [generated in 0.00053s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
[generated in 0.00053s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
2026-02-05 15:51:01,270 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
[2m2026-02-05T14:51:01.271571Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m240.37[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments[0m [36mrequest_id[0m=[35m98895057-b3ae-49e9-a744-16dd450d362b[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:01,278 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,279 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:01,279 INFO sqlalchemy.engine.Engine [cached since 0.1803s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.1803s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,289 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
2026-02-05 15:51:01,289 INFO sqlalchemy.engine.Engine [generated in 0.00079s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
[generated in 0.00079s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
2026-02-05 15:51:01,295 INFO sqlalchemy.engine.Engine SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
2026-02-05 15:51:01,296 INFO sqlalchemy.engine.Engine [generated in 0.00069s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[generated in 0.00069s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:01,304 INFO sqlalchemy.engine.Engine UPDATE appointments SET status=$1::appointmentstatus, updated_at=now() WHERE appointments.id = $2::UUID
UPDATE appointments SET status=$1::appointmentstatus, updated_at=now() WHERE appointments.id = $2::UUID
2026-02-05 15:51:01,305 INFO sqlalchemy.engine.Engine [generated in 0.00050s] ('no_show', UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
[generated in 0.00050s] ('no_show', UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
2026-02-05 15:51:01,313 INFO sqlalchemy.engine.Engine INSERT INTO user_debts (user_id, establishment_id, appointment_id, amount, status, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::NUMERIC(10, 2), $5::debtstatus, $6::UUID) RETURNING user_debts.created_at, user_debts.updated_at
INSERT INTO user_debts (user_id, establishment_id, appointment_id, amount, status, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::NUMERIC(10, 2), $5::debtstatus, $6::UUID) RETURNING user_debts.created_at, user_debts.updated_at
2026-02-05 15:51:01,314 INFO sqlalchemy.engine.Engine [generated in 0.00063s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'), 50.0, 'pending', UUID('01353bb2-766e-443f-99c9-39533d1a238b'))
[generated in 0.00063s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'), 50.0, 'pending', UUID('01353bb2-766e-443f-99c9-39533d1a238b'))
2026-02-05 15:51:01,331 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
[2m2026-02-05T14:51:01.334943Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m61.13[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments/6c6f6865-193a-4773-95e3-b9f5853984d5/no-show[0m [36mrequest_id[0m=[35m77669996-037b-4fb6-a765-6610a1a558c2[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:01,341 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,342 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:01,342 INFO sqlalchemy.engine.Engine [cached since 0.2432s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.2432s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,346 INFO sqlalchemy.engine.Engine SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
2026-02-05 15:51:01,346 INFO sqlalchemy.engine.Engine [cached since 0.1967s ago] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
[cached since 0.1967s ago] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
2026-02-05 15:51:01,349 INFO sqlalchemy.engine.Engine SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
2026-02-05 15:51:01,349 INFO sqlalchemy.engine.Engine [cached since 0.1894s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
[cached since 0.1894s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
2026-02-05 15:51:01,351 INFO sqlalchemy.engine.Engine SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
2026-02-05 15:51:01,352 INFO sqlalchemy.engine.Engine [cached since 0.1814s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[cached since 0.1814s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:01,355 INFO sqlalchemy.engine.Engine SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
2026-02-05 15:51:01,355 INFO sqlalchemy.engine.Engine [cached since 0.1613s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 8, 15, 51, 1, 336389, tzinfo=datetime.timezone.utc))
[cached since 0.1613s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 8, 15, 51, 1, 336389, tzinfo=datetime.timezone.utc))
2026-02-05 15:51:01,358 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
2026-02-05 15:51:01,358 INFO sqlalchemy.engine.Engine [cached since 0.1553s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc))
[cached since 0.1553s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc))
2026-02-05 15:51:01,362 INFO sqlalchemy.engine.Engine INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
2026-02-05 15:51:01,362 INFO sqlalchemy.engine.Engine [cached since 0.1288s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 8, 15, 51, 1, 336389), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'))
[cached since 0.1288s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 8, 15, 51, 1, 336389), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'))
2026-02-05 15:51:01,365 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
2026-02-05 15:51:01,371 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,372 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
2026-02-05 15:51:01,372 INFO sqlalchemy.engine.Engine [cached since 0.1167s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
[cached since 0.1167s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
2026-02-05 15:51:01,375 INFO sqlalchemy.engine.Engine SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
2026-02-05 15:51:01,376 INFO sqlalchemy.engine.Engine [cached since 0.1132s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
[cached since 0.1132s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
2026-02-05 15:51:01,381 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
[2m2026-02-05T14:51:01.381644Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m44.68[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments[0m [36mrequest_id[0m=[35m378e0c57-09b9-417a-a042-402860a8f368[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:01,432 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,433 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:01,433 INFO sqlalchemy.engine.Engine [cached since 0.3342s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.3342s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,442 INFO sqlalchemy.engine.Engine SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
2026-02-05 15:51:01,442 INFO sqlalchemy.engine.Engine [generated in 0.00057s] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
[generated in 0.00057s] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
2026-02-05 15:51:01,447 INFO sqlalchemy.engine.Engine SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
2026-02-05 15:51:01,448 INFO sqlalchemy.engine.Engine [generated in 0.00051s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
[generated in 0.00051s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
2026-02-05 15:51:01,452 INFO sqlalchemy.engine.Engine SELECT services.id AS services_id, services.establishment_id AS services_establishment_id, services.name AS services_name, services.description AS services_description, services.price AS services_price, services.duration_minutes AS services_duration_minutes, services.active AS services_active, services.sort_order AS services_sort_order, services.deposit_required AS services_deposit_required, services.created_at AS services_created_at, services.updated_at AS services_updated_at 
FROM services 
WHERE services.id IN ($1::UUID)
SELECT services.id AS services_id, services.establishment_id AS services_establishment_id, services.name AS services_name, services.description AS services_description, services.price AS services_price, services.duration_minutes AS services_duration_minutes, services.active AS services_active, services.sort_order AS services_sort_order, services.deposit_required AS services_deposit_required, services.created_at AS services_created_at, services.updated_at AS services_updated_at 
FROM services 
WHERE services.id IN ($1::UUID)
2026-02-05 15:51:01,453 INFO sqlalchemy.engine.Engine [generated in 0.00046s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
[generated in 0.00046s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
2026-02-05 15:51:01,459 INFO sqlalchemy.engine.Engine SELECT user_debts.user_id, user_debts.establishment_id, user_debts.appointment_id, user_debts.amount, user_debts.status, user_debts.id, user_debts.created_at, user_debts.updated_at 
FROM user_debts 
WHERE user_debts.user_id = $1::UUID AND user_debts.establishment_id = $2::UUID AND user_debts.status = $3::debtstatus
SELECT user_debts.user_id, user_debts.establishment_id, user_debts.appointment_id, user_debts.amount, user_debts.status, user_debts.id, user_debts.created_at, user_debts.updated_at 
FROM user_debts 
WHERE user_debts.user_id = $1::UUID AND user_debts.establishment_id = $2::UUID AND user_debts.status = $3::debtstatus
2026-02-05 15:51:01,459 INFO sqlalchemy.engine.Engine [generated in 0.00046s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'pending')
[generated in 0.00046s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'pending')
2026-02-05 15:51:01,469 INFO sqlalchemy.engine.Engine INSERT INTO payments (user_id, establishment_id, appointment_id, subscription_id, purpose, amount, platform_fee, gateway_fee, net_amount, status, stripe_payment_id, stripe_payment_method, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::paymentpurpose, $6::NUMERIC(10, 2), $7::NUMERIC(10, 2), $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::paymentstatus, $11::VARCHAR, $12::VARCHAR, $13::UUID) RETURNING payments.created_at, payments.updated_at
INSERT INTO payments (user_id, establishment_id, appointment_id, subscription_id, purpose, amount, platform_fee, gateway_fee, net_amount, status, stripe_payment_id, stripe_payment_method, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::paymentpurpose, $6::NUMERIC(10, 2), $7::NUMERIC(10, 2), $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::paymentstatus, $11::VARCHAR, $12::VARCHAR, $13::UUID) RETURNING payments.created_at, payments.updated_at
2026-02-05 15:51:01,470 INFO sqlalchemy.engine.Engine [generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'), None, 'single', 70.0, 3.5, 2.1, 64.39999999999999, 'pending', 'pi_debt', None, UUID('6caa0581-37b7-4911-b772-2e60f8f14dc7'))
[generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'), None, 'single', 70.0, 3.5, 2.1, 64.39999999999999, 'pending', 'pi_debt', None, UUID('6caa0581-37b7-4911-b772-2e60f8f14dc7'))
2026-02-05 15:51:01,491 INFO sqlalchemy.engine.Engine COMMIT
COMMIT
[2m2026-02-05T14:51:01.498027Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m73.77[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/create-intent[0m [36mrequest_id[0m=[35m2fc021cb-0bc0-4a19-abf9-9236320eddf2[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
2026-02-05 15:51:01,505 INFO sqlalchemy.engine.Engine BEGIN (implicit)
BEGIN (implicit)
2026-02-05 15:51:01,506 INFO sqlalchemy.engine.Engine SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
2026-02-05 15:51:01,506 INFO sqlalchemy.engine.Engine [cached since 0.407s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[cached since 0.407s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,516 INFO sqlalchemy.engine.Engine SELECT user_wallets.user_id, user_wallets.balance, user_wallets.id, user_wallets.created_at, user_wallets.updated_at 
FROM user_wallets 
WHERE user_wallets.user_id = $1::UUID
SELECT user_wallets.user_id, user_wallets.balance, user_wallets.id, user_wallets.created_at, user_wallets.updated_at 
FROM user_wallets 
WHERE user_wallets.user_id = $1::UUID
2026-02-05 15:51:01,517 INFO sqlalchemy.engine.Engine [generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
[generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
2026-02-05 15:51:01,528 INFO sqlalchemy.engine.Engine INSERT INTO user_wallets (user_id, balance, id) VALUES ($1::UUID, $2::NUMERIC(12, 2), $3::UUID) RETURNING user_wallets.created_at, user_wallets.updated_at
INSERT INTO user_wallets (user_id, balance, id) VALUES ($1::UUID, $2::NUMERIC(12, 2), $3::UUID) RETURNING user_wallets.created_at, user_wallets.updated_at
2026-02-05 15:51:01,529 INFO sqlalchemy.engine.Engine [generated in 0.00053s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 0.0, UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'))
[generated in 0.00053s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 0.0, UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'))
2026-02-05 15:51:01,538 INFO sqlalchemy.engine.Engine SELECT wallet_transactions.wallet_id AS wallet_transactions_wallet_id, wallet_transactions.type AS wallet_transactions_type, wallet_transactions.amount AS wallet_transactions_amount, wallet_transactions.status AS wallet_transactions_status, wallet_transactions.description AS wallet_transactions_description, wallet_transactions.reference_id AS wallet_transactions_reference_id, wallet_transactions.id AS wallet_transactions_id, wallet_transactions.created_at AS wallet_transactions_created_at, wallet_transactions.updated_at AS wallet_transactions_updated_at 
FROM wallet_transactions 
WHERE $1::UUID = wallet_transactions.wallet_id ORDER BY wallet_transactions.created_at DESC
SELECT wallet_transactions.wallet_id AS wallet_transactions_wallet_id, wallet_transactions.type AS wallet_transactions_type, wallet_transactions.amount AS wallet_transactions_amount, wallet_transactions.status AS wallet_transactions_status, wallet_transactions.description AS wallet_transactions_description, wallet_transactions.reference_id AS wallet_transactions_reference_id, wallet_transactions.id AS wallet_transactions_id, wallet_transactions.created_at AS wallet_transactions_created_at, wallet_transactions.updated_at AS wallet_transactions_updated_at 
FROM wallet_transactions 
WHERE $1::UUID = wallet_transactions.wallet_id ORDER BY wallet_transactions.created_at DESC
2026-02-05 15:51:01,539 INFO sqlalchemy.engine.Engine [generated in 0.00057s] (UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'),)
[generated in 0.00057s] (UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'),)
2026-02-05 15:51:01,541 INFO sqlalchemy.engine.Engine ROLLBACK
ROLLBACK
[2m2026-02-05T14:51:01.545313Z[0m [[31m[1merror    [0m] [1mUnhandled exception           [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36merror[0m=[35m"1 validation error for WalletResponse\ntransactions\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]\n    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error"[0m [36mmethod[0m=[35mGET[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/wallet[0m [36mrequest_id[0m=[35mb263c93b-b6ae-4314-a479-f00b5427a735[0m [36mversion[0m=[35m1.0.0[0m
  + Exception Group Traceback (most recent call last):
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    |     return WalletResponse.model_validate(wallet)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
    | transactions
    |   Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    |     For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    return WalletResponse.model_validate(wallet)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
transactions
  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
  + Exception Group Traceback (most recent call last):
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    |     return WalletResponse.model_validate(wallet)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
    | transactions
    |   Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    |     For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    return WalletResponse.model_validate(wallet)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
transactions
  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
[2m2026-02-05T14:51:01.558948Z[0m [[31m[1merror    [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m58.71[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mGET[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/wallet[0m [36mrequest_id[0m=[35mb263c93b-b6ae-4314-a479-f00b5427a735[0m [36mstatus_code[0m=[35m500[0m [36mversion[0m=[35m1.0.0[0m
F[2m2026-02-05T14:51:01.642903Z[0m [[32m[1minfo     [0m] [1mShutting down application     [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m
[2m2026-02-05T14:51:01.652827Z[0m [[32m[1minfo     [0m] [1mDatabase connections closed   [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m

=================================== FAILURES ===================================
_________________________ test_no_show_and_wallet_flow _________________________

client = <httpx.AsyncClient object at 0x7904b0fb7f20>

    @pytest.mark.asyncio
    async def test_no_show_and_wallet_flow(client: AsyncClient):
        # ─── 1. Setup ────────────────────────────────────────────────────────────
        phone = "+5511988887777"
        resp = await client.post("/api/v1/auth/send-code", json={"phone": phone})
        code = resp.json()["message"].split(": ")[1].strip()
        resp = await client.post("/api/v1/auth/verify", json={"phone": phone, "code": code})
        token = resp.json()["tokens"]["access_token"]
        headers = {"Authorization": f"Bearer {token}"}
    
        # Create Establishment with 50% No-Show Fee
        est_resp = await client.post("/api/v1/establishments", json={
            "name": "Advanced Barbershop",
            "category": "barbershop",
            "address": "Feature St",
            "city": "São Paulo",
            "state": "SP",
            "phone": "+551177777777",
            "no_show_fee_percent": 50.0,
            "business_hours": {day: {"open": "00:00", "close": "23:59"} for day in ["mon", "tue", "wed", "thu", "fri", "sat", "sun"]}
        }, headers=headers)
        est_id = est_resp.json()["id"]
    
        # Create Staff
        staff_resp = await client.post(f"/api/v1/establishments/{est_id}/staff", json={
            "name": "Expert Barber",
            "role": "barber",
            "work_schedule": {day: {"open": "00:00", "close": "23:59"} for day in ["mon", "tue", "wed", "thu", "fri", "sat", "sun"]}
        }, headers=headers)
        staff_id = staff_resp.json()["id"]
    
        # Create Service (R$ 100,00)
        svc_resp = await client.post(f"/api/v1/establishments/{est_id}/services", json={
            "name": "Luxury Cut",
            "price": 100.0,
            "duration_minutes": 60,
            "deposit_required": True
        }, headers=headers)
        svc_id = svc_resp.json()["id"]
    
        # ─── 2. Test Deposit Requirement ─────────────────────────────────────────
        appt_resp = await client.post("/api/v1/appointments", json={
            "establishment_id": est_id,
            "service_id": svc_id,
            "staff_id": staff_id,
            "scheduled_at": (datetime.now() + timedelta(days=2)).isoformat(),
            "payment_type": "single"
        }, headers=headers)
        assert appt_resp.status_code == 201
        appointment = appt_resp.json()
        # Status should be awaiting_deposit because svc.deposit_required=True
        assert appointment["status"] == "awaiting_deposit"
        appt_id = appointment["id"]
    
        # ─── 3. Test No-Show Penalty ─────────────────────────────────────────────
        # Manually mark as no-show (we skip the checks for staff role for this test)
        no_show_resp = await client.post(f"/api/v1/appointments/{appt_id}/no-show", headers=headers)
        assert no_show_resp.status_code == 200
    
        # Check if debt was created (50% of 100.0 = 50.0)
        # Actually we can check it via a new appointment intent
        appt2_resp = await client.post("/api/v1/appointments", json={
            "establishment_id": est_id,
            "service_id": svc_id,
            "staff_id": staff_id,
            "scheduled_at": (datetime.now() + timedelta(days=3)).isoformat(),
            "payment_type": "single"
        }, headers=headers)
        appt2_id = appt2_resp.json()["id"]
    
        # Create intent should now be R$ 20 (deposit 20% of 100) + R$ 50 (debt) = R$ 70
        # Note: Establishment deposit_percent defaults to 0, but Service.deposit_required defaults to 20% in PaymentService if est is 0
        from unittest.mock import patch, MagicMock
        with patch("stripe.PaymentIntent.create") as mock_stripe:
            mock_stripe.return_value = MagicMock(id="pi_debt", client_secret="secret_debt")
            intent_resp = await client.post("/api/v1/payments/create-intent", json={"appointment_id": appt2_id}, headers=headers)
            assert intent_resp.status_code == 200
            # Deposit (20) + Debt (50) = 70
            assert intent_resp.json()["amount"] == 70.0
    
        # ─── 4. Test Wallet Balance ──────────────────────────────────────────────
        wallet_resp = await client.get("/api/v1/payments/wallet", headers=headers)
>       assert wallet_resp.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/api/v1/test_advanced_payments.py:88: AssertionError
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector
DEBUG    asyncio:selector_events.py:64 Using selector: EpollSelector
INFO     app.main:main.py:28 [2m2026-02-05T14:51:00.228690Z[0m [[32m[1minfo     [0m] [1mStarting application          [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mname[0m=[35m'Navaro API'[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:1846 select pg_catalog.version()
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 select current_schema()
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 show standard_conforming_strings
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00065s] ('users', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02178s ago] ('establishments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02549s ago] ('service_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02965s ago] ('services', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03334s ago] ('service_bundles', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03577s ago] ('service_bundle_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03865s ago] ('staff_members', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.0406s ago] ('staff_blocks', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04212s ago] ('subscription_plans', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04426s ago] ('subscription_plan_items', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04697s ago] ('subscriptions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04984s ago] ('subscription_usage', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.05241s ago] ('appointments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.05526s ago] ('appointment_products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.05821s ago] ('checkins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.06073s ago] ('queue_entries', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.06349s ago] ('reviews', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.06536s ago] ('favorites', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.06835s ago] ('favorite_staff', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.0701s ago] ('payments', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.07477s ago] ('tips', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.07766s ago] ('payouts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.08068s ago] ('portfolio_images', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.08323s ago] ('search_history', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.08547s ago] ('products', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.08795s ago] ('establishment_plugins', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.08973s ago] ('ad_campaigns', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.09332s ago] ('notifications', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.09705s ago] ('user_debts', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1004s ago] ('user_wallets', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1037s ago] ('wallet_transactions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00058s] ('userrole', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.007259s ago] ('establishmentcategory', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.01206s ago] ('establishmentstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.01623s ago] ('subscriptiontier', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02044s ago] ('subscriptionstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02526s ago] ('appointmentstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02839s ago] ('paymenttype', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03148s ago] ('queuestatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03397s ago] ('paymentpurpose', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03696s ago] ('paymentstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04091s ago] ('notificationtype', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.0444s ago] ('debtstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04758s ago] ('transactiontype', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT pg_catalog.pg_type.typname 
FROM pg_catalog.pg_type JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_type.typnamespace 
WHERE pg_catalog.pg_type.typname = $1::VARCHAR AND pg_catalog.pg_type_is_visible(pg_catalog.pg_type.oid) AND pg_catalog.pg_namespace.nspname != $2::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.0523s ago] ('transactionstatus', 'pg_catalog')
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     app.main:main.py:37 [2m2026-02-05T14:51:00.477510Z[0m [[32m[1minfo     [0m] [1mDatabase initialized          [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m
------------------------------ Captured log call -------------------------------
INFO     app.api.v1.auth:auth.py:96 [2m2026-02-05T14:51:00.484614Z[0m [[32m[1minfo     [0m] [1mVerification code sent        [0m [[0m[1m[34mapp.api.v1.auth[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/send-code[0m [36mphone[0m=[35m+5511988887777[0m [36mrequest_id[0m=[35m3cc0a62e-dc57-4010-a42f-7947bcce6511[0m [36mversion[0m=[35m1.0.0[0m
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:00.485475Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m5.28[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/send-code[0m [36mrequest_id[0m=[35m3cc0a62e-dc57-4010-a42f-7947bcce6511[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.phone = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00052s] ('+5511988887777',)
INFO     app.api.v1.auth:auth.py:168 [2m2026-02-05T14:51:00.694056Z[0m [[32m[1minfo     [0m] [1mUser authenticated            [0m [[0m[1m[34mapp.api.v1.auth[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/verify[0m [36mrequest_id[0m=[35m87ad2b89-8e8b-40be-bcba-45b7d1db45f9[0m [36muser_id[0m=[35m1bec427c-d8f4-47f8-963a-f2dcba2a6133[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2713 ROLLBACK
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:00.695812Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m208.69[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/auth/verify[0m [36mrequest_id[0m=[35m87ad2b89-8e8b-40be-bcba-45b7d1db45f9[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00038s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00067s] ('advanced-barbershop',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02532s ago] ('advanced-barbershop-1',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.02744s ago] ('advanced-barbershop-2',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03052s ago] ('advanced-barbershop-3',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03459s ago] ('advanced-barbershop-4',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03705s ago] ('advanced-barbershop-5',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.03932s ago] ('advanced-barbershop-6',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04124s ago] ('advanced-barbershop-7',)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.slug = $1::VARCHAR
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.04567s ago] ('advanced-barbershop-8',)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO establishments (owner_id, name, slug, category, description, address, city, state, zip_code, latitude, longitude, phone, whatsapp, logo_url, cover_url, google_place_id, google_maps_url, business_hours, queue_mode_enabled, status, subscription_tier, stripe_account_id, cancellation_fee_fixed, no_show_fee_percent, deposit_percent, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::establishmentcategory, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::NUMERIC(10, 8), $11::NUMERIC(11, 8), $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::JSON, $19::BOOLEAN, $20::establishmentstatus, $21::subscriptiontier, $22::VARCHAR, $23::NUMERIC(10, 2), $24::NUMERIC(5, 2), $25::NUMERIC(5, 2), $26::UUID) RETURNING establishments.created_at, establishments.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00103s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 'Advanced Barbershop', 'advanced-barbershop-8', 'barbershop', None, 'Feature St', 'São Paulo', 'SP', None, None, None, '+551177777777', None, None, None, None, None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', False, 'pending', 'trial', None, 0.0, 50.0, 0.0, UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00025s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:2713 ROLLBACK
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:00.792463Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m94.41[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments[0m [36mrequest_id[0m=[35mc3d64587-d529-4167-8f86-a26bf86c2f0d[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.09661s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00052s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO staff_members (establishment_id, user_id, name, phone, role, avatar_url, work_schedule, commission_rate, active, id) VALUES ($1::UUID, $2::UUID, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::JSON, $8::NUMERIC(5, 2), $9::BOOLEAN, $10::UUID) RETURNING staff_members.created_at, staff_members.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00072s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), None, 'Expert Barber', None, 'barber', None, '{"mon": {"open": "00:00", "close": "23:59"}, "tue": {"open": "00:00", "close": "23:59"}, "wed": {"open": "00:00", "close": "23:59"}, "thu": {"open":  ... (10 characters truncated) ... close": "23:59"}, "fri": {"open": "00:00", "close": "23:59"}, "sat": {"open": "00:00", "close": "23:59"}, "sun": {"open": "00:00", "close": "23:59"}}', None, True, UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00059s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
INFO     sqlalchemy.engine.Engine:base.py:2713 ROLLBACK
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:00.977745Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m182.59[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments/b5fe8b83-db99-451f-9e3a-165ca14a88de/staff[0m [36mrequest_id[0m=[35ma5cbb7fb-9516-4163-a159-36adc6c45be0[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.2815s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1813s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO services (establishment_id, name, description, price, duration_minutes, active, sort_order, deposit_required, id) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::NUMERIC(10, 2), $5::INTEGER, $6::BOOLEAN, $7::INTEGER, $8::BOOLEAN, $9::UUID) RETURNING services.created_at, services.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00070s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'Luxury Cut', None, 100.0, 60, True, 0, True, UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00104s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
INFO     sqlalchemy.engine.Engine:base.py:2713 ROLLBACK
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.027531Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m47.36[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/establishments/b5fe8b83-db99-451f-9e3a-165ca14a88de/services[0m [36mrequest_id[0m=[35m3b09b916-e981-4822-bc9d-936524caaba1[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:1846 select pg_catalog.version()
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 select current_schema()
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:1846 show standard_conforming_strings
INFO     sqlalchemy.engine.Engine:base.py:1846 [raw sql] ()
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00035s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00045s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00086s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00066s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00039s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 7, 15, 51, 1, 30577, tzinfo=datetime.timezone.utc))
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00050s] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 7, 16, 51, 1, 30577, tzinfo=datetime.timezone.utc))
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00083s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 7, 15, 51, 1, 30577), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00040s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00053s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.271571Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m240.37[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments[0m [36mrequest_id[0m=[35m98895057-b3ae-49e9-a744-16dd450d362b[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1803s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00079s] (UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00069s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 UPDATE appointments SET status=$1::appointmentstatus, updated_at=now() WHERE appointments.id = $2::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00050s] ('no_show', UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'))
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user_debts (user_id, establishment_id, appointment_id, amount, status, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::NUMERIC(10, 2), $5::debtstatus, $6::UUID) RETURNING user_debts.created_at, user_debts.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00063s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('6c6f6865-193a-4773-95e3-b9f5853984d5'), 50.0, 'pending', UUID('01353bb2-766e-443f-99c9-39533d1a238b'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.334943Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m61.13[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments/6c6f6865-193a-4773-95e3-b9f5853984d5/no-show[0m [36mrequest_id[0m=[35m77669996-037b-4fb6-a765-6610a1a558c2[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.2432s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT services.establishment_id, services.name, services.description, services.price, services.duration_minutes, services.active, services.sort_order, services.deposit_required, services.id, services.created_at, services.updated_at 
FROM services 
WHERE services.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1967s ago] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT staff_members.establishment_id, staff_members.user_id, staff_members.name, staff_members.phone, staff_members.role, staff_members.avatar_url, staff_members.work_schedule, staff_members.commission_rate, staff_members.active, staff_members.id, staff_members.created_at, staff_members.updated_at 
FROM staff_members 
WHERE staff_members.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1894s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.owner_id, establishments.name, establishments.slug, establishments.category, establishments.description, establishments.address, establishments.city, establishments.state, establishments.zip_code, establishments.latitude, establishments.longitude, establishments.phone, establishments.whatsapp, establishments.logo_url, establishments.cover_url, establishments.google_place_id, establishments.google_maps_url, establishments.business_hours, establishments.queue_mode_enabled, establishments.status, establishments.subscription_tier, establishments.stripe_account_id, establishments.cancellation_fee_fixed, establishments.no_show_fee_percent, establishments.deposit_percent, establishments.id, establishments.created_at, establishments.updated_at 
FROM establishments 
WHERE establishments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1814s ago] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT staff_blocks.staff_id, staff_blocks.start_at, staff_blocks.end_at, staff_blocks.reason, staff_blocks.id, staff_blocks.created_at, staff_blocks.updated_at 
FROM staff_blocks 
WHERE staff_blocks.staff_id = $1::UUID AND staff_blocks.start_at < $2::TIMESTAMP WITH TIME ZONE AND staff_blocks.end_at > $3::TIMESTAMP WITH TIME ZONE
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1613s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc), datetime.datetime(2026, 2, 8, 15, 51, 1, 336389, tzinfo=datetime.timezone.utc))
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.staff_id = $1::UUID AND appointments.status != $2::appointmentstatus AND appointments.scheduled_at < $3::TIMESTAMP WITH TIME ZONE
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1553s ago] (UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), 'cancelled', datetime.datetime(2026, 2, 8, 16, 51, 1, 336389, tzinfo=datetime.timezone.utc))
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO appointments (user_id, establishment_id, staff_id, service_id, bundle_id, subscription_id, scheduled_at, duration_minutes, status, payment_type, notes, cancel_reason, total_price, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::UUID, $6::UUID, $7::TIMESTAMP WITH TIME ZONE, $8::INTEGER, $9::appointmentstatus, $10::paymenttype, $11::VARCHAR, $12::VARCHAR, $13::NUMERIC(10, 2), $14::UUID) RETURNING appointments.created_at, appointments.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1288s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('570d6a33-ef8a-44a7-baca-4d267875d7f8'), UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'), None, None, datetime.datetime(2026, 2, 8, 15, 51, 1, 336389), 60, 'awaiting_deposit', 'single', None, None, 100.0, UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1167s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointment_products.appointment_id AS appointment_products_appointment_id, appointment_products.product_id AS appointment_products_product_id, appointment_products.quantity AS appointment_products_quantity, appointment_products.unit_price AS appointment_products_unit_price, appointment_products.id AS appointment_products_id, appointment_products.created_at AS appointment_products_created_at, appointment_products.updated_at AS appointment_products_updated_at 
FROM appointment_products 
WHERE appointment_products.appointment_id IN ($1::UUID)
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.1132s ago] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.381644Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m44.68[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/appointments[0m [36mrequest_id[0m=[35m378e0c57-09b9-417a-a042-402860a8f368[0m [36mstatus_code[0m=[35m201[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.3342s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT appointments.user_id, appointments.establishment_id, appointments.staff_id, appointments.service_id, appointments.bundle_id, appointments.subscription_id, appointments.scheduled_at, appointments.duration_minutes, appointments.status, appointments.payment_type, appointments.notes, appointments.cancel_reason, appointments.total_price, appointments.id, appointments.created_at, appointments.updated_at 
FROM appointments 
WHERE appointments.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00057s] (UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT establishments.id AS establishments_id, establishments.owner_id AS establishments_owner_id, establishments.name AS establishments_name, establishments.slug AS establishments_slug, establishments.category AS establishments_category, establishments.description AS establishments_description, establishments.address AS establishments_address, establishments.city AS establishments_city, establishments.state AS establishments_state, establishments.zip_code AS establishments_zip_code, establishments.latitude AS establishments_latitude, establishments.longitude AS establishments_longitude, establishments.phone AS establishments_phone, establishments.whatsapp AS establishments_whatsapp, establishments.logo_url AS establishments_logo_url, establishments.cover_url AS establishments_cover_url, establishments.google_place_id AS establishments_google_place_id, establishments.google_maps_url AS establishments_google_maps_url, establishments.business_hours AS establishments_business_hours, establishments.queue_mode_enabled AS establishments_queue_mode_enabled, establishments.status AS establishments_status, establishments.subscription_tier AS establishments_subscription_tier, establishments.stripe_account_id AS establishments_stripe_account_id, establishments.cancellation_fee_fixed AS establishments_cancellation_fee_fixed, establishments.no_show_fee_percent AS establishments_no_show_fee_percent, establishments.deposit_percent AS establishments_deposit_percent, establishments.created_at AS establishments_created_at, establishments.updated_at AS establishments_updated_at 
FROM establishments 
WHERE establishments.id IN ($1::UUID)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00051s] (UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT services.id AS services_id, services.establishment_id AS services_establishment_id, services.name AS services_name, services.description AS services_description, services.price AS services_price, services.duration_minutes AS services_duration_minutes, services.active AS services_active, services.sort_order AS services_sort_order, services.deposit_required AS services_deposit_required, services.created_at AS services_created_at, services.updated_at AS services_updated_at 
FROM services 
WHERE services.id IN ($1::UUID)
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00046s] (UUID('1fbf5606-543f-4563-8212-74c6cdf2f747'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT user_debts.user_id, user_debts.establishment_id, user_debts.appointment_id, user_debts.amount, user_debts.status, user_debts.id, user_debts.created_at, user_debts.updated_at 
FROM user_debts 
WHERE user_debts.user_id = $1::UUID AND user_debts.establishment_id = $2::UUID AND user_debts.status = $3::debtstatus
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00046s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), 'pending')
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO payments (user_id, establishment_id, appointment_id, subscription_id, purpose, amount, platform_fee, gateway_fee, net_amount, status, stripe_payment_id, stripe_payment_method, id) VALUES ($1::UUID, $2::UUID, $3::UUID, $4::UUID, $5::paymentpurpose, $6::NUMERIC(10, 2), $7::NUMERIC(10, 2), $8::NUMERIC(10, 2), $9::NUMERIC(10, 2), $10::paymentstatus, $11::VARCHAR, $12::VARCHAR, $13::UUID) RETURNING payments.created_at, payments.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), UUID('b5fe8b83-db99-451f-9e3a-165ca14a88de'), UUID('7b10a932-de74-4b81-b2e0-c2f881bf9a54'), None, 'single', 70.0, 3.5, 2.1, 64.39999999999999, 'pending', 'pi_debt', None, UUID('6caa0581-37b7-4911-b772-2e60f8f14dc7'))
INFO     sqlalchemy.engine.Engine:base.py:2716 COMMIT
INFO     app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.498027Z[0m [[32m[1minfo     [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m73.77[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mPOST[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/create-intent[0m [36mrequest_id[0m=[35m2fc021cb-0bc0-4a19-abf9-9236320eddf2[0m [36mstatus_code[0m=[35m200[0m [36mversion[0m=[35m1.0.0[0m
INFO     sqlalchemy.engine.Engine:base.py:2710 BEGIN (implicit)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT users.phone, users.name, users.email, users.avatar_url, users.role, users.referral_code, users.referred_by_id, users.id, users.created_at, users.updated_at 
FROM users 
WHERE users.id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [cached since 0.407s ago] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT user_wallets.user_id, user_wallets.balance, user_wallets.id, user_wallets.created_at, user_wallets.updated_at 
FROM user_wallets 
WHERE user_wallets.user_id = $1::UUID
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00061s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'),)
INFO     sqlalchemy.engine.Engine:base.py:1846 INSERT INTO user_wallets (user_id, balance, id) VALUES ($1::UUID, $2::NUMERIC(12, 2), $3::UUID) RETURNING user_wallets.created_at, user_wallets.updated_at
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00053s] (UUID('1bec427c-d8f4-47f8-963a-f2dcba2a6133'), 0.0, UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'))
INFO     sqlalchemy.engine.Engine:base.py:1846 SELECT wallet_transactions.wallet_id AS wallet_transactions_wallet_id, wallet_transactions.type AS wallet_transactions_type, wallet_transactions.amount AS wallet_transactions_amount, wallet_transactions.status AS wallet_transactions_status, wallet_transactions.description AS wallet_transactions_description, wallet_transactions.reference_id AS wallet_transactions_reference_id, wallet_transactions.id AS wallet_transactions_id, wallet_transactions.created_at AS wallet_transactions_created_at, wallet_transactions.updated_at AS wallet_transactions_updated_at 
FROM wallet_transactions 
WHERE $1::UUID = wallet_transactions.wallet_id ORDER BY wallet_transactions.created_at DESC
INFO     sqlalchemy.engine.Engine:base.py:1846 [generated in 0.00057s] (UUID('58a8ee87-e0c2-421f-a804-5668ded83a22'),)
INFO     sqlalchemy.engine.Engine:base.py:2713 ROLLBACK
ERROR    app.core.middleware:middleware.py:104 [2m2026-02-05T14:51:01.545313Z[0m [[31m[1merror    [0m] [1mUnhandled exception           [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36merror[0m=[35m"1 validation error for WalletResponse\ntransactions\n  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]\n    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error"[0m [36mmethod[0m=[35mGET[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/wallet[0m [36mrequest_id[0m=[35mb263c93b-b6ae-4314-a479-f00b5427a735[0m [36mversion[0m=[35m1.0.0[0m
  + Exception Group Traceback (most recent call last):
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    |     return WalletResponse.model_validate(wallet)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
    | transactions
    |   Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    |     For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    return WalletResponse.model_validate(wallet)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
transactions
  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
  + Exception Group Traceback (most recent call last):
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 192, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |   File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    |     return await call_next(request)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    |     raise app_exc from app_exc.__cause__ or app_exc.__context__
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    |     return WalletResponse.model_validate(wallet)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    |     return cls.__pydantic_validator__.validate_python(
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    | pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
    | transactions
    |   Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    |     For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
    +------------------------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 78, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
  File "/usr/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/core/middleware.py", line 175, in dispatch
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/fastapi/routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/app/api/v1/payments.py", line 104, in get_my_wallet
    return WalletResponse.model_validate(wallet)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for WalletResponse
transactions
  Error extracting attribute: MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s) [type=get_attribute_error, input_value=<UserWallet(id=58a8ee87-e...421f-a804-5668ded83a22)>, input_type=UserWallet]
    For further information visit https://errors.pydantic.dev/2.12/v/get_attribute_error
ERROR    app.core.middleware:middleware.py:56 [2m2026-02-05T14:51:01.558948Z[0m [[31m[1merror    [0m] [1mRequest completed             [0m [[0m[1m[34mapp.core.middleware[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36mduration_ms[0m=[35m58.71[0m [36menvironment[0m=[35mdevelopment[0m [36mmethod[0m=[35mGET[0m [36mmode[0m=[35mdebug[0m [36mpath[0m=[35m/api/v1/payments/wallet[0m [36mrequest_id[0m=[35mb263c93b-b6ae-4314-a479-f00b5427a735[0m [36mstatus_code[0m=[35m500[0m [36mversion[0m=[35m1.0.0[0m
---------------------------- Captured log teardown -----------------------------
INFO     app.main:main.py:42 [2m2026-02-05T14:51:01.642903Z[0m [[32m[1minfo     [0m] [1mShutting down application     [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m
INFO     app.main:main.py:44 [2m2026-02-05T14:51:01.652827Z[0m [[32m[1minfo     [0m] [1mDatabase connections closed   [0m [[0m[1m[34mapp.main[0m][0m [36mapp[0m=[35m'Navaro API'[0m [36menvironment[0m=[35mdevelopment[0m [36mmode[0m=[35mdebug[0m [36mversion[0m=[35m1.0.0[0m
=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /root/projetos/navaro/packages/api/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

app/api/v1/users.py:16
  /root/projetos/navaro/packages/api/app/api/v1/users.py:16: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class UserResponse(BaseModel):

app/api/v1/establishments.py:65
  /root/projetos/navaro/packages/api/app/api/v1/establishments.py:65: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class EstablishmentResponse(BaseModel):

app/api/v1/services.py:40
  /root/projetos/navaro/packages/api/app/api/v1/services.py:40: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class ServiceResponse(BaseModel):

app/api/v1/staff.py:41
  /root/projetos/navaro/packages/api/app/api/v1/staff.py:41: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    class StaffResponse(BaseModel):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/api/v1/test_advanced_payments.py::test_no_show_and_wallet_flow
1 failed, 5 warnings in 1.46s
